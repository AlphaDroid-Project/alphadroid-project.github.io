<div class="container">
  <h1 id="devices-title">Devices</h1>
  <p id="devices-subtitle">Browse available devices below.</p>

  <div id="device-search-wrapper" class="field large prefix round fill active" style="max-width:640px;margin:16px auto;">
    <i class="front">search</i>
    <input id="device-search-input" placeholder="Search devices (OEM, model, codename)" autocomplete="off" />
    <menu class="min" id="device-search-suggestions" style="display:none"></menu>
  </div>
  <div id="oem-filter-chips" class="center-align" style="display:flex;flex-wrap:wrap;gap:6px;justify-content:center;margin:4px auto 12px;max-width:760px;"></div>

  <div class="devices-container">
    <!-- loadDevices will populate this area -->
  </div>
</div>

<script>
  // If this fragment is loaded directly (e.g. when fetched as a standalone file),
  // attempt to render devices. If loadDevices isn't present yet, wait until load.
  (function () {
    function tryLoad() {
      if (typeof loadDevices === 'function') {
        try { loadDevices(0); } catch (e) { console.error(e); }
        return true;
      }
      return false;
    }
    if (!tryLoad()) {
      window.addEventListener('load', tryLoad);
      setTimeout(tryLoad, 300);
    }
  })();

  (function(){
    const el = document.getElementById('device-search-input');
    if(el){
      el.addEventListener('input', () => {
        window.__deviceSearchQuery = el.value || '';
        if (typeof loadDevices === 'function') loadDevices(0);
      });
    }
  })();

  // Update content from configuration
  window.addEventListener('configReady', function(event) {
    const config = event.detail.config;
    const devices = config?.content?.devices;
    
    if (devices) {
      const titleEl = document.getElementById('devices-title');
      const subtitleEl = document.getElementById('devices-subtitle');
      const searchInput = document.getElementById('device-search-input');
      
      if (titleEl && devices.title) {
        titleEl.textContent = devices.title;
      }
      if (subtitleEl && devices.subtitle) {
        subtitleEl.textContent = devices.subtitle;
      }
      if (searchInput && devices.searchPlaceholder) {
        searchInput.placeholder = devices.searchPlaceholder;
      }
    }
  });
</script>

